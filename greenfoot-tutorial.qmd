---
title: Tutorial do Greenfoot
subtitle: GAC125 - IPOO
---

# Sobre o Tutorial {background-color="#40666e"}

Este tutorial apresenta o Greenfoot, uma IDE baseada no BlueJ e usada para cria√ß√£o de jogos 
e simula√ß√µes em Java.

##

N√≥s estamos usando o Greenfoot na aula porque 

- o trabalho da disciplina ter√° como tema a implementa√ß√£o de um jogo com gr√°ficos em 2D, 
- desenvolvido em Java, com a IDE Greenfoot.

. . .

Em casa, voc√™ pode baixar e instalar o greenfoot acessando o site: [https://greenfoot.org/download]()

. . .

Este material se baseia no tutorial disponibilizado no site do Greenfoot: [https://www.greenfoot.org/doc/tut-1]()

- Mas ele foi estendido esse semestre, trazendo mais conte√∫do.

# Parte 1: Interagindo com o Greenfoot {background-color="#40666e"}

## A interface do Greenfoot {.smaller}

Baixe o projeto [greenfoot-ursos](https://github.com/ufla-ipoo/greenfoot-ursos) e abra-o no Greenfoot.

. . .

A interface do Greenfoot tem tr√™s √°reas principais.

- O **mundo**.
  - Na maior parte da tela aparece o mundo do jogo.
- As **classes**.
  - S√£o exibidas em *caixas* no diagrama do lado direito.
- E os bot√µes de **controle de execu√ß√£o**.
  - Bot√µes abaixo do mundo que permitem controlar a execu√ß√£o do jogo.

## Colocando objetos no mundo {.smaller}

Clique com o bot√£o direito na classe `Urso` e acesse a op√ß√£o `new Urso()`.

- E ent√£o clique em qualquer lugar do mundo.
- Voc√™ acabou de criar um objeto `Urso`.

. . .

Fa√ßa o mesmo tipo de opera√ß√£o com as folhas, colocando algumas folhas no mundo.

. . .

**Dica**:

- Existe um atalho para colocar objetos no mundo.
- Selecione uma classe, e clique no mundo segurando a tecla `Shift` do teclado.

## Fazendo objetos agirem {.smaller}

Clique no bot√£o **Executar uma vez** (obs.: no Greenfoot em ingl√™s o bot√£o se chama `Act`).

- Ao clicar no bot√£o, cada objeto age.
- Ou seja, faz o que foi programado para fazer.

. . .

Neste exemplo, as folhas n√£o fazem nada.

- E os ursos s√£o programados para andar para frente.
- Experimente criar dois ursos e clicar de novo no bot√£o **Executar uma vez**. 
  - Os dois ursos v√£o se mover.

. . .

Ursos tamb√©m comem folhas.

- Experimente colocar uma folha na frente de um urso e clicar no bot√£o **Executar uma vez**.

## Chamar m√©todos diretamente {.smaller}

Em vez de executar todo o cen√°rio, voc√™ pode chamar m√©todos para cada objeto separadamente.

- Experimente clicar em um urso colocado no mundo.
- Voc√™ ver√° as op√ß√µes de chamar os m√©todos, da mesma forma que vemos no BlueJ.

. . .

Experimente chamar o m√©todo `virarAEsquerda` para algum urso.

- E depois o m√©todo `mover`.

. . .

Repare que h√° um m√©todo chamado `act`.

- √â este m√©todo que √© chamado toda vez que clicamos no bot√£o **Executar uma vez**.


## Criar um novo mundo {.smaller}

Voc√™ pode recome√ßar tudo, criando um novo mundo.

- Para isso use o obt√£o **Reiniciar**.
- O objeto do mundo ser√° descartado (junto com os objetos adicionados nele).
- E um novo mundo ser√° criado.
  - Obs.: S√≥ pode existir um mundo ativo por vez.

## Chamando um m√©todo do mundo {.smaller}

√â poss√≠vel tamb√©m chamar m√©todos do mundo.

- Basta clicar em uma √°rea vazia do mundo (sem ursos, nem folhas),
  - ou na √°rea cinza ao redor do mundo.
- E ser√£o exibidos os seus m√©todos.

. . .

Experimente chamar o m√©todo `povoar`.

- Este m√©todo cria v√°rios ursos e folhas.
- Execute ent√£o o jogo.

. . .

Experimente agora o m√©todo `folhasAleatorias`.

- A quantidade de folhas pode ser passada por par√¢metro.
- Obs.: √†s vezes pode parecer que n√£o apareceram todas as folhas.
  - Mas √© que pode acontecer de duas folhas acabarem caindo na mesma c√©lula.

## {.smaller}

Bom, chega de ursos andando em c√≠rculos...

- Vamos agora para outro exemplo no qual faremos algo mais interessante: [programar]{.alert}!

# Parte 2: Movimento e controle pelo teclado {background-color="#40666e"}

Nesta parte veremos como criar movimento, e usar o teclado para controlar um ator (personagem).

## O cen√°rio caranguejo {.smaller}

Baixe o projeto [greenfoot-caranguejo](https://github.com/ufla-ipoo/greenfoot-caranguejo) e abra-o no Greenfoot.

- Voc√™ ver√° um mundo de areia.

. . .

Crie um caranguejo e coloque-o no mundo.

- Clique ent√£o em **Executar**.
- Aconteceu alguma coisa?

## {.smaller}

O caranguejo n√£o fez nada porque n√£o tem nada programado para ele fazer.

- Vamos mudar isso!

. . .

Abra a classe Caranguejo (clicando duas vezes na caixa da classe).

- Veja que a classe tem um m√©todo `act` (agir) vazio, por isso o caranguejo n√£o faz nada.
- Experimente colocar o comando `move(4)` dentro do m√©todo `act`.
  - Compile a classe, coloque um caranguejo no mundo e clique em executar.
  - Veja que o caranguejo se move para a direita at√© parar na borda do mundo.
  - Voc√™ pode at√© pausar o mundo e arrastar o caranguejo para que ele ande novamente.

## S√≥ para os curiosos {.smaller}

Mas de onde veio esse m√©todo `move`? 

- E por que estamos chamando o m√©todo sem usar nenhum objeto?

. . .

N√≥s vamos entender isso melhor ao estudarmos o conceito de [Heran√ßa]{.alert}.

. . .

Mas, para os curiosos, vai aqui um *spoiler*:

- O m√©todo `move` (e outros que usaremos da mesma forma) est√° definido na classe `Actor`.
- A classe `Caranguejo` √© uma subclasse de `Actor`.
  - Isso significa que ela herda os m√©todos da classe `Actor`.
  - E assim, podemos chamar os m√©todos da classe `Actor` dentro da classe `Caranguejo` como se eles estivessem definidos na pr√≥pria classe `Caranguejo`.

## {.smaller}

Experimente agora colocar dois caranguejos e chamar o m√©todo **Executar**.

- Os dois caranguejos fazem a mesma coisa, pois s√£o objetos da mesma classe.

. . .

Experimente passar valores diferentes para o m√©todo `move`.

- Voc√™ pode testar valores menores, maiores e at√© negativos.

. . .

O m√©todo `move` faz um ator se mover para frente pela quantidade passada.

- Um ator sempre come√ßa "olhando" para a direita da tela.
- Portanto, a princ√≠pio, ele se move para a direita da tela.

## {.smaller}

Acrescente agora mais uma linha no m√©todo `act`, de forma que ele fique como mostrado abaixo:

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    move(4);
    turn(3);
```
:::

. . .

Execute o jogo, com alguns caranguejos e veja o que acontece.

- Experimente passar valores diferentes para o m√©todo `turn`.
  - Mais uma vez, valores maiores, menores e at√© negativos.

. . .

Note que o m√©todo `turn` gira o ator pelo √¢ngulo passado (em graus).

## Controle usando o teclado {.smaller}

Fica mais interessante se pudermos controlar o caranguejo.

- para isso, podemos usar o m√©todo est√°tico `isKeyDown` da classe `Greenfoot`.

. . .

Por exemplo, podemos verificar se a tecla seta para a esquerda est√° pressionada assim:

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    if (Greenfoot.isKeyDown("left")) {
        // implementamos aqui o que deve acontecer se a tecla seta para
        // a esquerda estiver pressionada
    }
```
:::

## {.smaller}

Experimente, por exemplo, implementar o m√©todo `act` conforme mostrado abaixo:

- Teste o jogo com um e com v√°rios caranguejos.
- Use seta para a esquerda e seta para a direita para controlar os caranguejos.

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    public void act() 
    {
        move(4);
        
        if (Greenfoot.isKeyDown("left")) {    
            turn(-3);   
        }
        if (Greenfoot.isKeyDown("right")) {    
            turn(3);   
        }
    }  
```
:::

## {.smaller}

Voc√™ pode alterar os valores passados para o m√©todo `turn` para mudar o quanto os caranguejos giram.

- E pode tamb√©m alterar as teclas utilizadas para controlar o caranguejo.
- Voc√™ pode usar as letras ou caracteres para indicar as teclas (ex.: `"a"`).
  - Ou os nomes das teclas (ex.: `"space"` ou `"control"`). 

. . .

Para pensar:

- Como voc√™ pode tratar para que o jogo possa ser jogado tanto nas teclas de dire√ß√£o quanto usando as teclas `ASDW`?

## Opcional: controlando um carro {.smaller}

Em casa, tente criar uma classe `Carro` e controlar os carros da seguinte forma:

- Usando seta para cima para acelerar o carro.
- Seta para baixo dar r√© no carro.
- Seta para a esquerda para virar o carro para a esquerda.
- Seta para a direita para virar o carro para a esquerda.

# Parte 3: Detectando e removendo atores {background-color="#40666e"}


Agora vamos descobrir como podemos detectar que um ator est√° tocando outro (detec√ß√£o de colis√£o), e como remover aquele ator do mundo.

## Comendo larvas {.smaller}

Vamos criar uma classe para representar larvas que ser√£o a comida dos caranguejos.

- Para isso clique com o bot√£o direito na classe `Actor` e v√° na op√ß√£o `Nova subclasse...`.

. . .

Na janela que se abre d√™ o nome `Larva` para a classe (lembre-se de usar `L` mai√∫sculo).

- E escolha a imagem `larva.png` para representar as larvas.
- Ao clicar em OK, a classe `Larva` aparecer√° no diagrama do Greenfoot.

. . .

Se abrir o c√≥digo da classe ver√° que ela ainda n√£o faz nada.

- Mas n√≥s vamos deixar assim.
- As larvas desse jogo s√£o pregui√ßosas e s√≥ ficam paradas mesmo.

## {.smaller}

A ideia agora √© modificar a classe `Caranguejo` para que um caranguejo coma uma larva sempre que passar sobre ela.

. . .

Para fazer isso, vamos usar o m√©todo `getOneIntersectingObject`.

- Podemos acrescentar o seguinte trecho de c√≥digo ao final do m√©todo `act`.

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    // se o caranguejo estiver colidindo (tocando) uma larva, a larva ser√°
    // retornada. Se n√£o estiver colidindo com nenhuma, o m√©todo retornar√° null.
    Actor larva = getOneIntersectingObject(Larva.class);
    // Se havia colis√£o com alguma larva
    if (larva != null) {
        // Obtemos uma refer√™ncia (ponteiro) para o mundo
        World mundo = getWorld();
        // Removemos a larva do mundo
        mundo.removeObject(larva);
    }
```
:::

## {.smaller}

Altere o m√©todo `act` conforme mostrado no slide anterior.

- Coloque v√°rias larvas e v√°rios caranguejos no mundo.
- E testes as altera√ß√µes. Conseguiu capturar todas as larvas?

## Coes√£o de m√©todo {.smaller}

Repare que nosso m√©todo `act` est√° ficando um pouco confuso.

- Isso porque ele agora faz duas coisas: movimenta o caranguejo e o faz comer larvas.

. . .

Como podemos melhorar isso?

- Podemos criar um m√©todo `movimentar` e outro `tentarComer`.
 - Levando para esses m√©todos os trechos de c√≥digo que hoje est√£o no m√©todo `act`.
- O m√©todo `act` passaria ent√£o a ter apenas duas linhas:

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    public void act() {
        movimentar();
        tentarComer();
    }
```
:::

## {.smaller}

Veja que, com a altera√ß√£o que fizemos, o c√≥digo fica mais f√°cil de entender e de se alterar.

- Mais adiante na disciplina aprofundaremos essa quest√£o, ao estudarmos o conceito [coes√£o de m√©todos]{.alert}.

# Parte 4: Salvando o mundo e criando e tocando sons {background-color="#40666e"}

Vamos aprender agora a inicializar o mundo j√° contendo atores.

- E tamb√©m a criar e tocar sons.

## Tamanho do mundo {.smaller}

A cada passo nosso jogo ter√° mais personagens.

- Pode ser interessante ent√£o criar um mundo de tamanho maior,
  aproveitando a resolu√ß√£o dispon√≠vel na tela do computador.

. . .

Para alterar o tamanho do mundo, fa√ßa o seguinte:

- Localize o construtor da classe `MundoDoCaranguejo`.
- Altere os dois primeiros par√¢metros da chamada `super`
  usando, por exemplo, 800 de largura e 600 de altura.
- Reinicie o jogo e teste.

. . .

Agora voc√™ tem mais espa√ßo para projetar seu jogo üòâ

## Salvando o mundo {.smaller}

Voc√™ deve ter ficado cansado de tanto colocar caranguejos e larvas no mundo.

- Mas n√≥s podemos adicionar c√≥digo para que isso seja feito automaticamente.
- Ou melhor ainda, pedir ao Greenfoot para fazer esse c√≥digo para n√≥s.

. . .

Para isso, fa√ßa o seguinte:

- Acrescente alguns caranguejos e algumas larvas no mundo.
- Antes de clicar em *Executar*, clique com o bot√£o direito no mundo e acesse a op√ß√£o **Salvar o mundo**.
  - O Greenfoot colocar√° trechos de c√≥digo na classe do mundo.
  - Que criam e posicionam os atores nos mesmos lugares onde voc√™ tinha colocado.
  - D√™ uma olhada no c√≥digo!

. . .

Depois disso, toda vez que o mundo for criado, ele j√° ter√° os caranguejos e as larvas
como voc√™ os tinha posicionado ao salvar. 

## Tocando sons {.smaller}

√â bem simples tocar sons no Greenfoot.

- Basta que voc√™ tenha um arquivo de som na pasta `sounds` do seu projeto.
- E use o m√©todo est√°tico `playSound` da classe `Greenfoot` para tocar o arquivo.

. . .

O projeto caranguejo j√° tem um arquivo `comendo.wav` na pasta `sounds`.

- Experimente ent√£o acrescentar a linha de c√≥digo abaixo na classe `Caranguejo`, logo ap√≥s remover uma larva do mundo:
  - `Greenfoot.playSound("comendo.wav");`
- Teste o jogo!

## Criando sons {.smaller}

Para criar seu jogo, voc√™ pode procurar por trilha e efeitos sonoros livres e gratuitos na internet.

- Ou voc√™ pode criar seus pr√≥prios sons usando o Greenfoot mesmo.

. . .

Para criar um som, acesse o menu `Ferramentas` &rarr; `Mostrar gravador de som...`.

- Voc√™ pode gravar sons e ouvi-los.
- E, ao final, dar um nome para o arquivo e salvar.
  - Depois, basta usar esse nome de arquivo no c√≥digo para toc√°-lo.

## Criando sons {.smaller}

[Dica]{.alert}:

- Sil√™ncios no in√≠cio ou no final do som podem criar uma experi√™ncia desagrad√°vel para o jogador.
- Voc√™ pode evitar isso usando o bot√£o `Cortar at√© a sele√ß√£o`.
  - Voc√™ pode selecionar o trecho do √°udio que tem a parte que voc√™ quer que fique no arquivo.
  - E usar o bot√£o para cortar o √°udio, ignorando o que tinha antes e depois da sele√ß√£o.


# Parte 5: Adicionando inimigo com movimento aleat√≥rio {background-color="#40666e"}

O jogo est√° muito f√°cil! √â hora de criarmos algum desafio.

## {.smaller}

Vamos criar uma lagosta que se move em linha reta e que pode comer caranguejos.

- Crie uma classe `Lagosta` clicando com o bot√£o direito em `Actor` e depois em `Nova subclasse...`.
- Escolha a imagem da lagosta que j√° existe no projeto.
  - Obs.: quando voc√™ quiser usar uma imagem que n√£o tem no Greenfoot, basta coloc√°-la na pasta `images` do projeto. 

. . .

Nas partes anteriores do tutorial j√° vimos como movimentar um ator e como remover um ator do mundo.

- Ent√£o voc√™ mesmo pode implementar a a√ß√£o da lagosta.
- Ela deve se movimentar sempre para a direita e,
  - Se colidir com um caranguejo, o caranguejo deve ser removido do mundo.
  - Para ficar mais interessante, grave o seu pr√≥prio som e use-o quando isso acontecer.

## Aleatoriedade {.smaller}

Bom, o jogo ainda est√° muito f√°cil. Vamos deix√°-lo menos previs√≠vel.

- A ideia √© que as lagostas possam girar a cada hora por um √¢ngulo diferente.
- Podemos fazer isso usando o m√©todo est√°tico `getRandomNumber` da classe `Greenfoot`.
  - Exemplo: `int angulo = Greenfoot.getRandomNumber(90);`.
- E ent√£o usamos o √¢ngulo como par√¢metro do m√©todo `turn`.
  - Exemplo: `turn(angulo);`.
- Implemente e teste o jogo.

. . .

O que achou do resultado?

- A lagosta n√£o √© um oponente desafiador ainda, certo? :)

## {.smaller}

Um dos problemas √© que a lagosta gira toda hora, com isso ela fica s√≥ rodopiando.

- Seria melhor se ela virasse apenas de vez em quando.
- Podemos implementar isso, fazendo com que o m√©todo `turn` n√£o seja chamado toda hora que o `act` √© executado.

. . .

Uma das formas de fazer isso √© mostrada abaixo.

- Experimente implementar e ver a diferen√ßa no comportamento da lagosta.


::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    move(4);
    if (Greenfoot.getRandomNumber(100) < 10) {
        int angulo = Greenfoot.getRandomNumber(90);
        turn(angulo);
    }
```
:::

## {.smaller}

Mas o que exatamente foi feito?

- Veja que o comando `Greenfoot.getRandomNumber(100)` retorna um n√∫mero aleat√≥rio entre 0 a 99.
- Se esse m√©todo for chamado muitas vezes ele vai retornar cada num√©ro poss√≠vel a mesma quantidade de vezes (em m√©dia).
  - Portanto, em m√©dia, ele retorna 0 em 1% das vezes, retorna 1 em 1% das vezes e assim por diante.
  - Logo, ele retorna um valor menor que 10 em 10% das vezes, certo?
- Com isso, a express√£o do comando `if (Greenfoot.getRandomNumber(100) < 10)`, retornar√° `true`, em m√©dia, a cada 10 vezes que for chamado.
  - Isso faz com que cada lagosta se movimente de forma diferente, girando s√≥ de vez em quando. 

## {.smaller}

Repare que podemos deixar a lagosta ainda melhor fazendo com que ela possa girar para os dois lados.

- Como estamos passando sempre um n√∫mero positivo, ela est√° girando sempre para o mesmo lado.
- Como podemos faz√™-la girar para os dois lados?

. . .

Podemos mudar a forma que o √¢ngulo √© definido:

- Agora teremos valores variando entre:
  - 0 - 45 = -45 
  - e 89 - 45 = 44.

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
        int angulo = Greenfoot.getRandomNumber(90) - 45;
```
:::

## {.smaller}

Fa√ßa as √∫ltimas altera√ß√µes no seu c√≥digo e coloque v√°rias lagostas e larvas, e alguns caranguejos no mundo.

- N√£o esque√ßa de salvar o mundo!
- Jogue e veja como a lagosta √© agora um inimigo bem mais desafiador.

. . .

Mas voc√™ deve ter reparado que a lagosta ainda n√£o sabe lidar bem com as bordas do mundo.

- Como podemos melhorar isso?
- Basta acrescentarmos um c√≥digo para que ela gire 180 graus sempre que chegar perto da borda do mundo.
  - Obs.: voc√™ pode chamar o m√©todo `isAtEdge` para verificar se um ator est√° na borda do mundo.

## Desafio (Opcional) {.smaller}

Como voc√™ poderia fazer um [jogo para dois jogadores]{.alert}?

- Imagine que um jogador utilize as setas do teclado e outro as teclas ASDW.
- Crie uma nova classe no jogo do caranguejo com um animal que possa ser controlado por um segundo jogador.
  - E fa√ßa os tratamentos necess√°rios.

# Parte 6: Exibindo informa√ß√µes na tela {background-color="#40666e"}

Vamos aprender como exibir informa√ß√µes na tela do jogo.

- Com isso poderemos exibir pontua√ß√µes, quantidade de vidas, mensagens para o jogador, etc.


## Exibindo um texto na tela {.smaller}

A classe `World` possui um m√©todo chamado `showText` que permite exibir um texto
em uma determinada posi√ß√£o da tela.

- O m√©todo recebe como par√¢metros uma String e as coordenadas X e Y que definem
  o ponto central do texto.

. . .

Vamos come√ßar ent√£o exibindo o texto `Jogo do Caranguejo` na tela.

- Para isso, altere a classe `MundoDoCaranguejo` acresentando a 
  linha abaixo no final do construtor da classe.

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    showText("Jogo do Caranguejo", 200, 20);
```
:::

. . .

Veja que o texto apareceu na parte superior da tela.

- Experimente posi√ß√µes diferentes.

## Mensagem de vit√≥ria {.smaller}

Agora que sabemos como exibir um texto na tela, podemos exibir uma
mensagem quando o jogador vence jogo.

- No nosso jogo, a vit√≥ria acontece quando todas as larvas s√£o devoradas.

. . .

Mas como saber se ainda existem larvas?

- A classe `World` possui um m√©todo chamado `getObjects` que permite
  consultar os objetos de uma determinada classe que est√£o presentes no mundo
  naquele momento.
- Portanto, se usarmos `getObjects(Larva.class)` vamos obter uma lista
  com as larvas que est√£o no mundo.
- Se a lista estiver vazia significa que jogador venceu o jogo.

. . .

Mas n√≥s precisamos verificar a todo momento se as larvas j√° acabaram, certo?

- Como fazer isso?

## Mensagem de vit√≥ria {.smaller}

Podemos implementar um m√©todo `act` na classe `MundoDoCaranguejo` com a mesma
assinatura dos m√©todos das classes de atores.

- Esse m√©todo tamb√©m √© chamado a cada itera√ß√£o do Greenfoot.
- Portanto, para tratar a mensagem de vit√≥ria, basta verificarmos 
  se ainda existe larva dentro desse m√©todo.

. . .

N√≥s vamos ent√£o implementar o m√©todo como mostrado abaixo.

- Mas, para ele compilar, precisaremos importar a classe `List`.
  - Podemos fazer isso acrescentado `import java.util.List;` no in√≠cio do arquivo.

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    public void act() {
        List<Larva> larvas = getObjects(Larva.class);
        if (larvas.size() == 0) {
            showText("Voce venceu!", 200, 300);
        }
    }
```
:::

## {.smaller}

A implementa√ß√£o que fizemos funciona, mas n√£o √© eficiente.

- Isso porque, depois que o jogador vence o jogo, a cada itera√ß√£o do Greenfoot, 
  um novo texto `"Voce venceu!"` √© colocado no lugar do anterior.
- Seria melhor se o texto fosse colocado apenas uma vez.

. . .

Como podemos fazer isso?

- Veja que podemos criar um atributo booleano para indicar se o jogo terminou.
- E us√°-lo para escrever a mensagem apenas uma vez.

. . .

Altere ent√£o a classe `MundoDoCaranguejo` acrescentando um booleano chamado
`jogoTerminou`.

- O atributo deve ser inicializado com valor `false` no construtor.
- E o m√©todo `act` deve ser alterado para utiliz√°-lo.

## {.smaller}

Vamos ent√£o alterar o m√©todo `act` como mostrado abaixo.

- Veja que foi acrescentado um `if` para que a lista de larvas s√≥
  seja verificada se o jogo ainda n√£o terminou.
- Al√©m disso, depois que o texto √© mostrado, o booleano `jogoTerminou`
  √© alterado para `true`.
- Com isso, o texto `"Voce venceu"` √© inserido na tela uma √∫nica vez.  

::: {.halfincfontsize}
```{.java code-line-numbers="false" code-line-numbers="2,6"}
    public void act() {
        if (!jogoTerminou) {
            List<Larva> larvas = getObjects(Larva.class);
            if (larvas.size() == 0) {
                showText("Voce venceu!", 200, 300);
                jogoTerminou = true;
            }
        }
    }
```
:::

## Game Over! {.smaller}

Baseado no que fizemos para a mensagem de vit√≥ria, exiba a mensagem
`"Game Over!"` quando todos os caranguejos forem comidos pelas lagostas.

- Veja que basta seguirmos a mesma ideia, mas agora verificando se ainda existem caranguejos em vez de larvas.

. . .

```{.java code-line-numbers="false" code-line-numbers="9-14"}
    public void act() {
        if (!jogoTerminou) {
            // verificando vitoria
            List<Larva> larvas = getObjects(Larva.class);
            if (larvas.size() == 0) {
                showText("Voce venceu!", 200, 300);
                jogoTerminou = true;
            }
            // verificando derrota
            List<Caranguejo> caranguejos = getObjects(Caranguejo.class);
            if (caranguejos.size() == 0) {
                showText("GameOver!", 200, 300);
                jogoTerminou = true;
            }
        }
    }
```

# Parte 7: Tratando pontua√ß√£o {background-color="#40666e"}

Agora que sabemos como exibir informa√ß√µes na tela, podemos fazer algo mais interessante.

- Podemos passar a contabilizar a pontua√ß√£o do jogador e exibi-la na tela.

## Contabilizando pontos {.smaller}

Para contabilizar os pontos do jogador, precisaremos:

- Criar um atributo na classe `MundoDoCaranguejo` para guardar a pontua√ß√£o.
- Criar um m√©todo para incrementar a pontua√ß√£o.
- Chamar esse m√©todo toda vez que um caranguejo comer uma larva.
- E exibir a pontua√ß√£o na tela, sempre que ela for alterada.

. . .

Altere ent√£o a classe `MundoDoCaranguejo` incluindo um atributo inteiro chamado `pontos`.

. . .

Em seguida, crie um m√©todo p√∫blico chamado `contarPontos` que:

- acrescenta 10 unidades ao atributo `pontos`;
- e exibe na tela o placar atualizado, utilizando o m√©todo `showText`

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
showText("Placar: " + pontos + " pontos", 200, 50);
```
:::

## {.smaller}

A pontua√ß√£o ainda n√£o aparece, porque precisamos agora chamar o 
m√©todo `contarPontos` toda vez que o caranguejo comer uma larva.

Para isso, altere o m√©todo `act` da classe `Caranguejo`.

- Localize o trecho de c√≥digo que remove a larva comida do jogo.
- Logo ap√≥s a remo√ß√£o da larva, chame do m√©todo `contarPontos` de `MundoDoCaranguejo`.
  - Para isso, precisaremos obter uma refer√™ncia do mundo como uma inst√¢ncia 
    da classe `MundoDoCaranguejo`.
  - Isso pode ser feito como mostrado abaixo.

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    MundoDoCaranguejo mundoCaranguejo = getWorldOfType(MundoDoCaranguejo.class);
    mundoCaranguejo.contarPontos();
```
:::

# Parte 8: Um inimigo que persegue as larvas {background-color="#40666e"}

Vamos dificultar um pouco mais a vida do jogador :)

## Criando aranhas comedoras de larvas {.smaller}

A ideia agora √© criar aranhas que tamb√©m comam larvas, e assim dificultem
a vida do jogador na obte√ß√£o de uma boa pontua√ß√£o.

- Num primeiro passo, vamos fazer uma vers√£o simplificada da aranha. 
- Ela sempre andar√° para frente e comer√° uma larva se der sorte de ter uma
no caminho dela.

. . .

Crie ent√£o uma classe `Aranha` de forma similar ao que fizemos antes.

- No m√©todo `act` da classe fa√ßa a aranha movimentar (com `move(2)`);
- e fa√ßa com que ela coma uma larva se tocar nela 
  - (com o mesmo c√≥digo que usamos para os caranguejos).

. . .

Posicione uma ou mais aranhas √† esquerda de algumas larvas e teste o jogo.

## Tornando as aranhas mais espertas {.smaller} 

Poder√≠amos deixar o jogo mais imprevis√≠vel se as aranhas se movimentassem
aleatoriamente como as lagotas.

- Mas podemos fazer algo ainda mais interessante:
  - Fazer com que as aranhas caminhem em dire√ß√£o √†s larvas de forma autom√°tica.

. . .

N√≥s podemos fazer isso usando o m√©todo `turnTowards`.

- Esse m√©todo vira um ator na dire√ß√£o das coordenadas passadas por par√¢metro.
- Portanto, se passarmos as coordenadas de uma larva, a aranha se movimentar√°
  em dire√ß√£o a ela.

. . .

N√≥s precisamos ent√£o ter uma maneira de identificar uma larva que seja
o alvo da aranha.

## {.smaller}

Nosso primeiro passo ser√° criar um m√©todo p√∫blico na classe `MundoCaranguejo` 

- que retorna qualquer uma das larvas existentes do mundo (escolhendo aleatoriamente).

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    public Larva buscarUmaLarva() {
        List<Larva> larvas = getObjects(Larva.class);
        if (larvas.size() > 0) {
            int posicao = Greenfoot.getRandomNumber(larvas.size());        
            return larvas.get(posicao);
        }
        return null;
    }
```
:::

## {.smaller}

N√≥s podemos agora chamar o m√©todo que criamos na classe `Aranha` para 
definir qual larva ela vai perseguir.

- Por enquanto vamos apenas guardar qual √© a larva-alvo.

. . .

Altere ent√£o a classe `Aranha` da seguinte forma:

- Crie um atributo do tipo `Larva` chamado `larvaAlvo`.
- Altere o m√©todo `act` para chamar o m√©todo `buscarUmaLarva` da classe
  `MundoDoCaranguejo`.

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false"}
    MundoDoCaranguejo mundoCaranguejo = getWorldOfType(MundoDoCaranguejo.class);
    larvaAlvo = mundoCaranguejo.buscarUmaLarva();
```
:::

. . .

Precisamos testar se o nosso m√©todo funciona, para isso fa√ßa o seguinte:

- Inicie o jogo e, em seguida, clique em `Pausar`.
- Clique com o bot√£o direito em uma aranha e acesse a op√ß√£o `Inspecionar`.
- Verifique o valor do atributo `larvaAlvo` clicando na seta.
  - Deve aparecer ent√£o as coordenadas da larva que foi definida como alvo.

## {.smaller}

Nosso pr√≥ximo passo √© ent√£o fazer com que a aranha se vire na dire√ß√£o
da larva alvo.

- Parece que basta acrescentar o trecho de c√≥digo abaixo ao final do m√©todo `act`.

. . .

::: {.halfincfontsize}
```{.java code-line-numbers="false" code-line-numbers="5-6"}
    public void act()
    {
        move(2);
        tentarComer();
        if (larvaAlvo != null) {
            turnTowards(larvaAlvo.getX(), larvaAlvo.getY());
        }
    }
```
:::

. . .

Funcionou?

- N√£o n√©? O problema √© que estamos escolhendo uma nova larva-alvo a cada itera√ß√£o do Greenfoot.
  - Com isso a aranha fica girando sem sentido.
- Como podemos resolver?


## {.smaller}

O que precisamos √© manter o alvo e s√≥ mudar quando a larva for devorada

- seja pela aranha, seja pelos caranguejos.

. . .

Podemos fazer isso com a seguite implementa√ß√£o no m√©todo `act`

```{.java code-line-numbers="false"}
    public void act()
    {
        move(2);
        tentarComer();

        // se j√° tem uma larva definida como alvo
        if (larvaAlvo != null) {
            // e ela ainda n√£o foi devorada
            if (larvaAlvo.getWorld() != null) {
                // a aranha se vira na dire√ß√£o dela
                turnTowards(larvaAlvo.getX(), larvaAlvo.getY());
            }
            else { // se a larva j√° foi devorada
                // reinicializamos o atributo para definir um novo alvo
                larvaAlvo = null;
            }
        }
        // se N√ÉO tem uma larva definida com o alvo
        if (larvaAlvo == null) {
            // definimos uma obtendo-a do mundo
            MundoDoCaranguejo mundoCaranguejo = getWorldOfType(MundoDoCaranguejo.class);
            larvaAlvo = mundoCaranguejo.buscarUmaLarva();
        }
    }
```

# Parte 9: Documenta√ß√£o do Greenfoot {background-color="#40666e"}

## {.smaller}

Para desenvolver jogos no Greenfoot √© importanter ter uma ideia do que ele √© capaz de fazer.

- Uma boa maneira de fazer isso √© consultando a sua documenta√ß√£o.

. . .

Voc√™ pode acessar a documenta√ß√£o do Greenfoot atrav√©s do menu:

- `Ajuda` &rarr; `Documenta√ß√£o de Classe Greenfoot`.

. . .

Ser√° exibida a documenta√ß√£o em HTML das classes dispon√≠veis do Greenfoot.

- Como `Actor`, `Font`, `Greenfoot`, `GreenfootImage` e `World`.
- Voc√™ pode clicar em uma classe e verificar os m√©todos que est√£o dispon√≠veis.

. . .

Voc√™ tamb√©m podem acessar diretamente a documenta√ß√£o das classes `Actor` e `World` clicando
nas caixas com esses nomes no painel direito do Greenfoot.

# Entrega {background-color="#40666e"}

## 

::: {.callout-important title="Entrega no Campus Virtual"}
Acesse, no Campus Virtual, a atividade correspondente a essa aula e envie o c√≥digo do projeto `greenfoot-caranguejo` da forma que ficou ap√≥s as suas altera√ß√µes (compacte a pasta do projeto em um arquivo `.zip` para enviar).
:::


